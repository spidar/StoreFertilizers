!function(){"use strict";angular.module("app").factory("servicesFactory",["$http",function(t){var e={},a="/api",n="/InvoicesAPI",o="/CreateNewInvoice",s="/InvoiceDetailsAPI",i="/PurchasesAPI",r="/StocksAPI",u="/ProvidersAPI",c="/GetProvidersList",d="/CustomersAPI",l="/GetCustomersList",p="/EmployeesAPI",f="/ProductsAPI",g="/GetProductsList",m="/ProductTypesAPI",D="/UnitTypesAPI",v="/BanksAPI",h="/PaymentTypesAPI";return e.getInvoices=function(){return t.get(a+n)},e.createNewInvoice=function(e){return t.get(a+n+o,{params:e})},e.getInvoices=function(e){return t.get(a+n,{params:e})},e.getInvoiceByID=function(e){return t.get(a+n+"/"+e)},e.insertInvoice=function(e){return t.post(a+n,e)},e.updateInvoice=function(e){return t.put(a+n+"/"+e.invoiceID,e)},e.deleteInvoiceByID=function(e){return t["delete"](a+n+"/"+e)},e.getInvoiceDetails=function(e){return t.get(a+s,{params:e})},e.getInvoiceDetailByID=function(e){return t.get(a+s+"/"+e)},e.insertInvoiceDetail=function(e){return t.post(a+s,e)},e.updateInvoiceDetail=function(e){return t.put(a+s+"/"+e.invoiceDetailsID,e)},e.deleteInvoiceDetailByID=function(e){return t["delete"](a+s+"/"+e)},e.getPurchases=function(e){return t.get(a+i,{params:e})},e.getPurchaseTax=function(){return t.get(a+i+"/GetPurchaseTax")},e.getPurchaseByID=function(e){return t.get(a+i+"/"+e)},e.insertPurchase=function(e){return t.post(a+i,e)},e.updatePurchase=function(e){return t.put(a+i+"/"+e.purchaseID,e)},e.deletePurchaseByID=function(e){return t["delete"](a+i+"/"+e)},e.getStocks=function(e){return t.get(a+r,{params:e})},e.getStockByID=function(e){return t.get(a+r+"/"+e)},e.insertStock=function(e){return t.post(a+r,e)},e.updateStock=function(e){return t.put(a+r+"/"+e.stockID,e)},e.deleteStockByID=function(e){return t["delete"](a+r+"/"+e)},e.getProviders=function(){return t.get(a+u+c)},e.getProvidersByParams=function(e){return t.get(a+u,{params:e})},e.getProviderByID=function(e){return t.get(a+u+"/"+e)},e.getCustomers=function(){return t.get(a+d+l)},e.getCustomersByParams=function(e){return t.get(a+d,{params:e})},e.getCustomerByID=function(e){return t.get(a+d+"/"+e)},e.getEmployees=function(){return t.get(a+p)},e.getEmployeeByID=function(e){return t.get(a+p+"/"+e)},e.getProductsList=function(){return t.get(a+f+g)},e.getProducts=function(e){return t.get(a+f,{params:e})},e.getProductByID=function(e){return t.get(a+f+"/"+e)},e.getProductTypes=function(){return t.get(a+m)},e.getProductTypeByID=function(e){return t.get(a+m+"/"+e)},e.getUnitTypes=function(){return t.get(a+D)},e.getUnitTypeByID=function(e){return t.get(a+D+"/"+e)},e.getBanks=function(){return t.get(a+v)},e.getBankByID=function(e){return t.get(a+v+"/"+e)},e.getPaymentTypes=function(){return t.get(a+h)},e.getPaymentTypByID=function(e){return t.get(a+h+"/"+e)},e}])}(),function(){"use strict";angular.module("app").directive("customdatepicker",["$parse",function(t){return{restrict:"A",require:"ngModel",link:function(t,e,a,n){$(function(){var o={format:"DD/MM/YYYY"};e.datetimepicker(o),e.bind("blur keyup change",function(){t.$apply(function(){var t=e.val();if(""==t.trim())return void n.$setViewValue("");var a=moment(t,"DD/MM/YYYY").utcOffset(),o=new Date(moment(t,"DD/MM/YYYY").add(a,"m"));o?n.$setViewValue(o):(e.val("Invalid Date"),n.$setViewValue(""))})});var s=function(t){return t?moment(t).format("DD/MM/YYYY"):""};n.$formatters.push(s),t.$watch(a.ngModel,function(t){return t?void e.val(moment(t).format("DD/MM/YYYY")):""})})}}}])}(),function(){"use strict";angular.module("app").controller("dashboardController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){t.isShowSalesChart=!0,t.isShowProductStockChart=!0,t.lineChartLabels=["ม.ค.","ก.พ.","ม.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค."],t.lineChartSeries=["ปุ๋ย","ยา"],t.lineChartData=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],t.pieChartLabels=["Download Sales","In-Store Sales","Mail-Order Sales"],t.pieChartData=[300,500,100],t.barChartLabels=["กระต่าย","ยาร่า","OX-PREMIUM","ออติวา","ไธอะโนซาน","พรีมาตรอน","ไดเทสเอ็ม"],t.barChartSeries=["สต๊อค","คงเหลือ"],t.barChartData=[[65,59,80,81,56,55,90],[28,48,40,19,26,27,40]]}])}(),function(){"use strict";angular.module("app").controller("customersController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){t.status="",t.showLoading=!1,t.data={totalPages:0,totalItems:0,filterOptions:{filterText:"",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:[],field:"name",directions:["desc","asc"],sortReverse:!1},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.customers={},t.getCustomersByFilters=function(){t.isNewItem&&t.reset(t.selected),t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getCustomersByParams(e).then(function(e){t.customers=e.data.content,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},function(){t.getCustomersByFilters()}()}])}(),function(){"use strict";angular.module("app").controller("invoicesController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){function s(t){var e=angular.lowercase(t);return function(t){return angular.lowercase(t.name).indexOf(e)>=0}}{var i=new Date,r=i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear(),u=moment(r,"DD/MM/YYYY").utcOffset(),c=new Date(moment(r,"DD/MM/YYYY").add(u,"m"));moment(r,"DD/MM/YYYY").add(u,"m")}t.title="",t.status="",t.showLoading=!1,t.isEditMode=!1,t.expandme=!0,t.data={printMode:!1,printValueOnly:!0,customerList:null,employeeList:null,productList:null,unitTypeList:null,purchaseList:null},t.invoices={},t.companyInfo={name:"หจก. เจริญถาวร",address:"94 ม.4 ต.โรงเข้ อ.บ้านแพ้ว จ.สมุทรสาคร 74120",phone:"(034) 467611-2",mobile:"mobile number",fax:"(034) 4676113",taxernuber:"07"},t.newInvoice={createdDate:c,dueDate:"",invoiceDetails:[],netTotal:0,isTax:!1},t.getAllCustomer=function(){o.getCustomers().then(function(e){t.data.customerList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลลูกค้าได้: "+e.statusText})},t.getAllEmployee=function(){o.getEmployees().then(function(e){t.data.employeeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลลูกจ้างได้: "+e.statusText})},t.getAllProducts=function(){o.getProductsList().then(function(e){t.data.productList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลสินค้าได้: "+e.statusText})},t.getAllUnitTypes=function(){o.getUnitTypes().then(function(e){t.data.unitTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลหน่วยได้: "+e.statusText})},t.getAllBanks=function(){o.getBanks().then(function(e){t.data.bankList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลธนาคารได้: "+e.statusText})},t.getAllPaymentTypes=function(){o.getPaymentTypes().then(function(e){t.data.paymentTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลชนิดของการจ่ายเงินได้: "+e.statusText})},t.getAllPurchases=function(){o.getPurchaseTax().then(function(e){t.data.purchaseList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลการซื้อสินค้าได้: "+e.statusText})},t.saveInvoice=function(){if(!t.newInvoice.customer)return t.status="กรุณาระบุลูกค้า",!1;if(0==t.newInvoice.invoiceDetails.length)return t.status="กรุณากรอกสินค้าอย่างน้อย 1 ชิ้น",!1;for(var n=0;n<t.newInvoice.invoiceDetails.length;n++)if(null==t.newInvoice.invoiceDetails[n].product)return t.status="กรุณากรอกสินค้าตามเครื่องหมาย ! ให้ถูกต้องและครบถ้วน",!1;var s=e.absUrl();t.showLoading=!0,s.indexOf("/Create")>=0?o.insertInvoice(t.newInvoice).then(function(e){t.status="...บันทีกเรียบร้อย !",t.showLoading=!1,a(function(){t.status=""},5e3)},function(e){t.showLoading=!1,t.status="ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText}):s.indexOf("/Edit/")>=0&&o.updateInvoice(t.newInvoice).then(function(e){t.status="...บันทีกเรียบร้อย !",t.showLoading=!1,a(function(){t.status=""},5e3)},function(e){t.showLoading=!1,t.status="ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText})},t.reindexItem=function(){for(var e=1,a=0;a<t.newInvoice.invoiceDetails.length;a++)1!=t.newInvoice.invoiceDetails[a].isDeleted&&(t.newInvoice.invoiceDetails[a].no=e,e+=1)},t.addItem=function(){var e={no:0,invoiceDetailsID:0,invoiceID:t.newInvoice.invoiceID,qty:0,pricePerUnit:0,discount:0,amount:0};t.newInvoice.invoiceDetails.push(e),t.reindexItem()},t.removeInvoiceDetail=function(e){if(1==confirm("โปรดยืนยันการลบ !")){if(t.newInvoice.isTax){var a=t.data.purchaseList.map(function(t){return t.purchaseID}).indexOf(e.purchaseID);if(-1!==a){var n=t.data.purchaseList[a];n.checked=!1}}0==e.invoiceDetailsID?t.newInvoice.invoiceDetails.splice(t.newInvoice.invoiceDetails.indexOf(e),1):e.isDeleted=!0,t.reindexItem()}},t.moneyToWord=function(t){var e="",a="";if(0>t&&(a="ติดลบ",t=-1*t),t=parseFloat(Math.round(100*t)/100).toFixed(2),"0.00"==t)return e="ศูนย์บาทถ้วน";var n=["","หนึ่ง","สอง","สาม","สี่","ห้า","หก","เจ็ด","แปด","เก้า"],o=["","สิบ","ร้อย","พัน","หมื่น","แสน"],s=t.length,i=[];if(!(15>=s))return e="Error: ไม่สามารถรองรับจำนวนเงินที่เกินหลักแสนล้าน";s>9?(i[0]=t.substr(0,s-9),i[1]=t.substr(i[0].length,6)):(i[0]="00",i[1]=t.substr(0,t.length-3)),i[2]=t.substr(t.indexOf(".")+1,2);for(var r=0;3>r;r++){var u=i[r];if("0"!=u&&"00"!=u)for(var s=u.length,c=0;s>c;c++){var d=u.substr(c,1),l=n[d],p="";if(""!=l&&(p=o[s-(c+1)]),s-c==2)"1"==d?l="":"2"==d&&(l="ยี่");else if(s-c==1&&1!=s){var f="0";c>0&&(f=u.substr(c-1,1)),0==r?"0"!=f&&"1"==d&&(l="เอ็ด"):"1"==d&&(l="เอ็ด")}e=e+l+p}0==r?"00"!=u&&(e+="ล้าน"):1==r?"0"!=u&&"00"!=u&&(e+="บาท","00"==i[2]&&(e+="ถ้วน")):"00"!=u&&(e+="สตางค์")}return a+e},t.calculateAmount=function(t){return t.amount=t.pricePerUnit*t.qty*(1-t.discount/100),t.amount},t.invoiceSubTotal=function(){var e=0;return angular.forEach(t.newInvoice.invoiceDetails,function(t,a){e+=t.amount}),e},t.invoiceTotalDiscount=function(){var e=0;return angular.forEach(t.newInvoice.invoiceDetails,function(t,a){e+=t.pricePerUnit*t.qty*(t.discount/100)}),e},t.calculateTax=function(){return 7*t.invoiceSubTotal()/100},t.calculateNetTotal=function(){return t.newInvoice.netTotal=t.invoiceSubTotal(),t.newInvoice.netTotal},t.calculateNetTotalText=function(){return t.newInvoice.netTotalText=t.moneyToWord(t.newInvoice.netTotal),t.newInvoice.netTotalText},t.purchaseItemChanged=function(e,a){var n=e.target,o=n.checked?"add":"remove",s=t.newInvoice.invoiceDetails.map(function(t){return t.purchaseID}).indexOf(a.purchaseID);if("add"===o&&-1===s){var i={invoiceDetailsID:0,purchaseID:a.purchaseID,no:0,productID:a.productID,product:angular.copy(a.product),unitTypeID:a.unitTypeID,unitType:angular.copy(a.unitType),invoiceID:t.newInvoice.invoiceID,qty:a.qtyRemain,pricePerUnit:0,discount:0,amount:0};t.newInvoice.invoiceDetails.push(i),t.reindexItem()}"remove"===o&&-1!==s&&(t.newInvoice.invoiceDetails.splice(t.newInvoice.invoiceDetails.indexOf(t.newInvoice.invoiceDetails[s]),1),t.reindexItem())},t.getProductMatches=function(e){var a=e?t.data.productList.filter(s(e)):t.data.productList;return a},t.getCustomerMatches=function(e){var a=e?t.data.customerList.filter(s(e)):t.data.customerList;return a},function(){t.getAllCustomer(),t.getAllProducts();var a=e.absUrl(),n=a.substr(a.lastIndexOf("/")+1);if(a.indexOf("/Create")>=0){var s={isTax:!1};a.indexOf("isTax=true")>=0&&(s.isTax=!0,t.getAllPurchases()),o.createNewInvoice(s).then(function(e){t.newInvoice=e.data,t.reindexItem()},function(e){t.status="ไม่สามารถตั้งค่าเริ่มต้นได้ "+e.statusText}),t.isEditMode=!1}else a.indexOf("/Edit/")>=0&&o.getInvoiceByID(n).then(function(e){t.newInvoice=e.data,t.isEditMode=!0,t.reindexItem()},function(e){t.status="ไม่สามารถโหลดข้อมูลใบส่งสินค้าได้ "+e.statusText})}()}])}(),function(){"use strict";angular.module("app").controller("invoicesIndexController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){var s=new Date,i=s.getDate()+"/"+(s.getMonth()+1)+"/"+s.getFullYear(),r=moment(i,"DD/MM/YYYY").utcOffset(),u=new Date(moment(i,"DD/MM/YYYY").add(r,"m")),c=moment(i,"DD/MM/YYYY").add(r,"m");t.status="",t.showLoading=!1,t.data={totalNetAmount:0,totalPages:0,totalItems:0,filterOptions:{filterText:"",isTax:"notax",fromCreatedDate:new Date(c.subtract(3,"day")),toCreatedDate:u,dueIn:"",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:["invoiceID","createdDate","invoiceNumber","cueDate","providerName"],field:"createdDate",directions:["desc","asc"],sortReverse:!0},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.invoices={},t.getInvoicesByFilters=function(){t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,fromCreatedDate:t.data.filterOptions.fromCreatedDate,toCreatedDate:t.data.filterOptions.toCreatedDate,isTax:t.data.filterOptions.isTax,dueIn:t.data.filterOptions.dueIn,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getInvoices(e).then(function(e){t.invoices=e.data.content,t.data.totalNetAmount=e.data.totalNetAmount,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},t.removeInvoice=function(e){1==confirm("โปรดยืนยันการลบ !")&&(t.showLoading=!0,o.deleteInvoiceByID(e.invoiceID).then(function(n){t.status="ลบเรียบร้อย",t.invoices.splice(t.invoices.indexOf(e),1),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถลบข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)}))},t.getInvoicesByFilters()}])}(),function(){"use strict";angular.module("app").controller("productsController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){t.status="",t.selected={},t.isNewItem=!1,t.showLoading=!1,t.data={productList:null,productTypeList:null,unitTypeList:null,totalPages:0,totalItems:0,filterOptions:{productType:null,filterText:"",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:["stockID","productNumber","productName","location","notes"],field:"productName",directions:["desc","asc"],sortReverse:!1},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.products={},t.getProductsByFilters=function(){t.isNewItem&&t.reset(t.selected),t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,productTypeID:t.data.filterOptions.productType?t.data.filterOptions.productType.productTypeID:0,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getProducts(e).then(function(e){t.products=e.data.content,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},function(){t.getProductsByFilters()}()}])}(),function(){"use strict";angular.module("app").controller("providersController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){t.status="",t.showLoading=!1,t.data={totalPages:0,totalItems:0,filterOptions:{filterText:"",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:[],field:"name",directions:["desc","asc"],sortReverse:!1},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.providers={},t.getProvidersByFilters=function(){t.isNewItem&&t.reset(t.selected),t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getProvidersByParams(e).then(function(e){t.providers=e.data.content,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},function(){t.getProvidersByFilters()}()}])}(),function(){"use strict";angular.module("app").controller("purchasesController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){function s(t){var e=angular.lowercase(t);return function(t){return angular.lowercase(t.name).indexOf(e)>=0}}var i=new Date,r=i.getDate()+"/"+(i.getMonth()+1)+"/"+i.getFullYear(),u=moment(r,"DD/MM/YYYY").utcOffset(),c=new Date(moment(r,"DD/MM/YYYY").add(u,"m")),d=moment(r,"DD/MM/YYYY").add(u,"m");t.status="",t.selected={},t.isNewItem=!1,t.showLoading=!1,t.data={providerList:null,productList:null,productTypeList:null,unitTypeList:null,totalPages:0,totalItems:0,filterOptions:{productType:null,filterText:"",fromPurchaseDate:new Date(d.subtract(3,"day")),toPurchaseDate:c,externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:["purchaseID","purchaseDate","billNumber","productName","providerName"],field:"purchaseDate",directions:["desc","asc"],sortReverse:!0},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.purchases={},t.newPurchase={},t.getPurchasesByFilters=function(){t.isNewItem&&t.reset(t.selected),t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,productTypeID:t.data.filterOptions.productType?t.data.filterOptions.productType.productTypeID:0,fromPurchaseDate:t.data.filterOptions.fromPurchaseDate,toPurchaseDate:t.data.filterOptions.toPurchaseDate,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getPurchases(e).then(function(e){t.purchases=e.data.content,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลการซื้อสินค้าได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},t.getAllProducts=function(){o.getProductsList().then(function(e){t.data.productList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลสินค้าได้: "+e.statusText})},t.getAllProviders=function(){o.getProviders().then(function(e){t.data.providerList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลผู้ให้บริการได้: "+e.statusText})},t.getAllProductTypes=function(){o.getProductTypes().then(function(e){t.data.productTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลชนิดสินค้าได้: "+e.statusText})},t.getAllUnitTypes=function(){o.getUnitTypes().then(function(e){t.data.unitTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลหน่วยได้: "+e.statusText})},t.getTemplate=function(e){return e.purchaseID===t.selected.purchaseID?"edit":"display"},t.reset=function(e){t.status="",t.selected={},t.isNewItem&&(t.purchases.splice(t.purchases.indexOf(e),1),t.isNewItem=!1)},t.editPurchase=function(e){t.isNewItem&&t.reset(t.selected),t.selected=angular.copy(e),t.selected.product.productUnitTypeName=e.productUnitTypeName,t.selected.orgProductID=t.selected.product.productID,t.selected.orgQty=t.selected.qty},t.addItem=function(){return t.isNewItem?!1:(t.selected={amount:0,billNumber:"",isTax:!1,notes:null,product:null,productID:0,provider:null,providerID:0,providerName:"",purchaseDate:moment().format("YYYY-MM-DDThh:mm:ss"),purchaseNumber:"",purchasePricePerUnit:0,qty:0,qtyRemain:0,salePrice:0,unitType:null,unitTypeID:0,vat:0},t.purchases.unshift(t.selected),void(t.isNewItem=!0))},t.updatePurchase=function(e){return t.myForm.$invalid||null==t.selected.product||null==t.selected.provider?(t.status="กรุณากรอกข้อมูลให้ถูกต้องและครบถ้วน",!1):(t.status="",t.showLoading=!0,void(t.isNewItem?o.insertPurchase(t.selected).then(function(n){t.purchases[e]=angular.copy(n.data),t.purchases[e].productUnitTypeName=n.data.productUnitTypeName,t.isNewItem=!1,t.reset(),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)}):o.updatePurchase(t.selected).then(function(n){t.purchases[e]=angular.copy(t.selected),t.reset(),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})))},t.removePurchase=function(e){1==confirm("โปรดยืนยันการลบ !")&&(t.showLoading=!0,o.deletePurchaseByID(e.purchaseID).then(function(n){t.status="",t.reset(),t.purchases.splice(t.purchases.indexOf(e),1),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถลบข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)}))},t.getProductMatches=function(e){var a=e?t.data.productList.filter(s(e)):t.data.productList;return a},t.getProviderMatches=function(e){var a=e?t.data.providerList.filter(s(e)):t.data.providerList;return a},function(){t.getPurchasesByFilters(),t.getAllProviders(),t.getAllProducts(),t.getAllProductTypes()}()}])}(),function(){"use strict";angular.module("app").controller("salesSummaryController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){var s=new Date,i=s.getDate()+"/"+(s.getMonth()+1)+"/"+s.getFullYear(),r=moment(i,"DD/MM/YYYY").utcOffset(),u=new Date(moment(i,"DD/MM/YYYY").add(r,"m"));t.status="",t.showLoading=!1,t.data={totalNetAmount:0,totalPages:0,totalItems:0,totalNetAmountDetails:0,totalPagesDetails:0,totalItemsDetails:0,totalProductDetails:0,toggleOptions:{itemID:"",itemCollape:!1,itemGroupping:!0},filterOptions:{filterText:"",filterTextDetails:"",isTax:"notax",fromCreatedDate:u,toCreatedDate:u,fromCreatedDateDetails:u,toCreatedDateDetails:u,sumIn:"today",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:["invoiceID","createdDate","invoiceNumber","cueDate","providerName"],field:"createdDate",directions:["desc","asc"],fieldDetails:"createdDate",directionsDetails:["desc","asc"],sortReverse:!0,sortReverseDetails:!0},pagingOptions:{pageSizes:[20,50,100],pageSize:500,currentPage:1,currentPageDetails:1}},t.lineChartLabels=[],t.lineChartSeries=["ยอดขาย"],t.lineChartData=[[]],t.invoices={},t.invoiceDetails={},t.sumInChange=function(e){var a=new Date(t.data.filterOptions.toCreatedDate);"today"==e&&(a=new Date);var n=a.getDate()+"/"+(a.getMonth()+1)+"/"+a.getFullYear(),o=moment(n,"DD/MM/YYYY").utcOffset(),s=moment(n,"DD/MM/YYYY").add(o,"m");"past7"==e?s=s.subtract(7,"day"):"past30"==e&&(s=s.subtract(30,"day")),t.data.filterOptions.fromCreatedDate=new Date(s),t.data.filterOptions.toCreatedDate=new Date(moment(n,"DD/MM/YYYY").add(o,"m"))},t.getInvoicesByFilters=function(){t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,fromCreatedDate:t.data.filterOptions.fromCreatedDate,toCreatedDate:t.data.filterOptions.toCreatedDate,isTax:t.data.filterOptions.isTax,sumIn:t.data.filterOptions.sumIn,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getInvoices(e).then(function(e){if(t.invoices=e.data.content,t.data.totalNetAmount=e.data.totalNetAmount,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,t.lineChartLabels=[],t.lineChartData=[[]],e.data.sumNetTotalEachDay)for(var n=0;n<e.data.sumNetTotalEachDay.length;n++)t.lineChartLabels.push(moment(e.data.sumNetTotalEachDay[n].createdDate).format("DD/MM/YYYY")),t.lineChartData[0].push(e.data.sumNetTotalEachDay[n].sumNetTotalPerDay);a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},t.getInvoiceDetailsByFilters=function(){t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,fromCreatedDate:t.data.filterOptions.fromCreatedDate,toCreatedDate:t.data.filterOptions.toCreatedDate,groupping:t.data.toggleOptions.itemGroupping,page:t.data.pagingOptions.currentPageDetails,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.fieldDetails,sortDirection:t.data.sortOptions.sortReverseDetails?"desc":"asc"};o.getInvoiceDetails(e).then(function(e){t.invoiceDetails=e.data.content,t.data.totalProductDetails=e.data.totalProducts,t.data.totalNetAmountDetails=e.data.totalNetAmount,t.data.totalItemsDetails=e.data.totalRecords,t.data.totalPagesDetails=e.data.totalPages,t.data.pagingOptions.currentPageDetails=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},t.updateViewByFilters=function(){t.getInvoicesByFilters(),t.getInvoiceDetailsByFilters()},t.getInvoicesByFilters(),t.getInvoiceDetailsByFilters()}])}(),function(){"use strict";angular.module("app").controller("stocksController",["$scope","$location","$timeout","$filter","servicesFactory",function(t,e,a,n,o){function s(t){var e=angular.lowercase(t);return function(t){return angular.lowercase(t.name).indexOf(e)>=0}}t.status="",t.selected={},t.isNewItem=!1,t.showLoading=!1,t.data={productList:null,productTypeList:null,unitTypeList:null,totalPages:0,totalItems:0,filterOptions:{productType:null,filterText:"",externalFilter:"searchText",useExternalFilter:!0},sortOptions:{fields:["stockID","productNumber","productName","location","notes"],field:"productName",directions:["desc","asc"],sortReverse:!1},pagingOptions:{pageSizes:[20,50,100],pageSize:50,currentPage:1}},t.stocks={},t.getStocksByFilters=function(){t.isNewItem&&t.reset(t.selected),t.showLoading=!0;var e={searchtext:t.data.filterOptions.filterText,productTypeID:t.data.filterOptions.productType?t.data.filterOptions.productType.productTypeID:0,page:t.data.pagingOptions.currentPage,pageSize:t.data.pagingOptions.pageSize,sortBy:t.data.sortOptions.field,sortDirection:t.data.sortOptions.sortReverse?"desc":"asc"};o.getStocks(e).then(function(e){t.stocks=e.data.content,t.data.totalItems=e.data.totalRecords,t.data.totalPages=e.data.totalPages,t.data.pagingOptions.currentPage=e.data.currentPage,a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถโหลดข้อมูลสต๊อกได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})},t.getAllProducts=function(){o.getProductsList().then(function(e){t.data.productList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลสินค้าได้: "+e.statusText})},t.getAllProductTypes=function(){o.getProductTypes().then(function(e){t.data.productTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลชนิดสินค้าได้: "+e.statusText})},t.getAllUnitTypes=function(){o.getUnitTypes().then(function(e){t.data.unitTypeList=e.data},function(e){t.status="ไม่สามารถโหลดข้อมูลหน่วยได้: "+e.statusText})},t.getTemplate=function(e){return e.stockID===t.selected.stockID?"edit":"display"},t.reset=function(e){t.status="",t.selected={},t.isNewItem&&(t.stocks.splice(t.stocks.indexOf(e),1),t.isNewItem=!1)},t.editStock=function(e){t.isNewItem&&t.reset(t.selected),t.selected=angular.copy(e),t.selected.product.productUnitTypeName=e.productUnitTypeName},t.addItem=function(){return t.isNewItem?!1:(t.selected={product:null,productID:0,balance:0,alertLowStock:!1,notes:null},t.stocks.unshift(t.selected),void(t.isNewItem=!0))},t.updateStock=function(e){return t.myForm.$invalid||null==t.selected.product?(t.status="กรุณากรอกข้อมูลให้ถูกต้องและครบถ้วน",!1):(t.status="",t.showLoading=!0,void(t.isNewItem?o.insertStock(t.selected).then(function(n){t.stocks[e]=angular.copy(n.data),t.stocks[e].productUnitTypeName=n.data.productUnitTypeName,t.isNewItem=!1,t.reset(),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status=409==e.status?"ไม่สามารถบันทึกข้อมูลได้ : มีสินค้านี้ในสต๊อกแล้ว":"ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)}):o.updateStock(t.selected).then(function(n){t.stocks[e]=angular.copy(t.selected),t.reset(),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถบันทึกข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)})))},t.removeStock=function(e){1==confirm("โปรดยืนยันการลบ !")&&(t.showLoading=!0,o.deleteStockByID(e.stockID).then(function(n){t.status="",t.reset(),t.stocks.splice(t.stocks.indexOf(e),1),a(function(){t.showLoading=!1,t.status=""},1e3)},function(e){t.status="ไม่สามารถลบข้อมูลได้ : "+e.statusText,a(function(){t.showLoading=!1},1e3)}))},t.getProductMatches=function(e){var a=e?t.data.productList.filter(s(e)):t.data.productList;return a},function(){t.getStocksByFilters(),t.getAllProducts(),t.getAllProductTypes()}()}])}(),function(){"use strict";angular.module("app",["ngRoute","ngMaterial","chart.js","ui.bootstrap.pagination"]).config(function(t){t.theme("default").primaryPalette("green").accentPalette("orange")}).config(function(t){t.setOptions({colours:["#803690","#00ADF9","#DCDCDC","#46BFBD","#FDB45C","#949FB1","#4D5360"]})}).config(function(t){t.boundaryLinks=!0,t.rotate=!1,t.maxSize=5,t.itemsPerPage=20,t.firstText="«",t.previousText="‹",t.nextText="›",t.lastText="»"})}();